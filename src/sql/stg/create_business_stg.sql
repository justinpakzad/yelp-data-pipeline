create table if not exists stg.business (
    business_id varchar, 
    name varchar,
    address varchar,
    city varchar,
    state varchar,
    postal_code varchar,
    latitude double precision,
    longitude double precision,
    stars double precision,
    review_count integer,
    is_open boolean,
    categories varchar(max),
    monday_opening_time varchar,
    monday_closing_time varchar,
    tuesday_opening_time varchar,
    tuesday_closing_time varchar,
    wednesday_opening_time varchar,
    wednesday_closing_time varchar,
    thursday_opening_time varchar,
    thursday_closing_time varchar,
    friday_opening_time varchar,
    friday_closing_time varchar,
    saturday_opening_time varchar,
    saturday_closing_time varchar,
    sunday_opening_time varchar,
    sunday_closing_time varchar,
    businessacceptscreditcards varchar,
    restaurantspricerange2 varchar,
    restaurantsdelivery varchar,
    restaurantstakeout varchar,
    bikeparking varchar,
    dogsallowed varchar,
    wheelchairaccessible varchar,
    coatcheck varchar,
    happyhour varchar,
    byappointmentonly varchar,
    caters varchar,
    restaurantsreservations varchar,
    outdoorseating varchar,
    hastv varchar,
    restaurantstableservice varchar,
    wifi varchar,
    goodforkids varchar,
    restaurantsattire varchar,
    restaurantsgoodforgroups varchar,
    noiselevel varchar,
    alcohol varchar,
    acceptsinsurance varchar,
    goodfordancing varchar,
    businessacceptsbitcoin varchar,
    byobcorkage varchar,
    byob varchar,
    corkage varchar,
    drivethru varchar,
    smoking varchar,
    agesallowed varchar,
    open24hours varchar,
    restaurantscounterservice varchar,
    businessparking_garage varchar,
    businessparking_lot varchar,
    businessparking_street varchar,
    businessparking_valet varchar,
    businessparking_validated varchar,
    ambience_casual varchar,
    ambience_classy varchar,
    ambience_divey varchar,
    ambience_hipster varchar,
    ambience_intimate varchar,
    ambience_romantic varchar,
    ambience_touristy varchar,
    ambience_trendy varchar,
    ambience_upscale varchar,
    goodformeal_breakfast varchar,
    goodformeal_brunch varchar,
    goodformeal_dessert varchar,
    goodformeal_dinner varchar,
    goodformeal_latenight varchar,
    goodformeal_lunch varchar,
    music_background_music varchar,
    music_dj varchar,
    music_jukebox varchar,
    music_karaoke varchar,
    music_live varchar,
    music_no_music varchar,
    music_video varchar,
    bestnights_friday varchar,
    bestnights_monday varchar,
    bestnights_saturday varchar,
    bestnights_sunday varchar,
    bestnights_thursday varchar,
    bestnights_tuesday varchar,
    bestnights_wednesday varchar,
    hairspecializesin_africanamerican varchar,
    hairspecializesin_asian varchar,
    hairspecializesin_coloring varchar,
    hairspecializesin_curly varchar,
    hairspecializesin_extensions varchar,
    hairspecializesin_kids varchar,
    hairspecializesin_perms varchar,
    hairspecializesin_straightperms varchar,
    dietaryrestrictions_dairyfree varchar,
    dietaryrestrictions_glutenfree varchar,
    dietaryrestrictions_halal varchar,
    dietaryrestrictions_kosher varchar,
    dietaryrestrictions_soyfree varchar,
    dietaryrestrictions_vegan varchar,
    dietaryrestrictions_vegetarian varchar
);

copy stg.business
from 's3://yelp-project/flattened_data/business.snappy.parquet'
iam_role 'Enter IAMROLE creds here'
format AS PARQUET;